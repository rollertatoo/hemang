/*! For license information please see ads.js.LICENSE.txt */
(self.webpackChunkoaks_journals_core=self.webpackChunkoaks_journals_core||[]).push([[695],{19265:()=>{const e=window.jQuery;let t,n;const o=(e,t)=>n.serverURL+"?correlator=[timestamp]&env=vp&gdfp_req=1&unviewed_position_start=1&output=vast&iu="+t+"&sz="+n.sizes+"&description_url="+encodeURIComponent(window.location.href)+"&url="+encodeURIComponent(window.location.href)+"&impl=s&cust_params="+encodeURIComponent(i(e)),i=n=>{if(!t||!t.pageTargeting)return;let o="";for(const e in t.pageTargeting){let n=t.pageTargeting[e];if(Array.isArray(n)){let e="";for(let t=0;t<n.length;t++)e+=t?",":"",e+=encodeURIComponent(n[t]);n=e}else n=encodeURIComponent(n);o+=o.length?"&":"",o+=e+"="+n}return void 0===t.pageTargeting.VideoName&&(o+=o.length?"&":"",o+="VideoName="+encodeURIComponent(e("[data-entry-id="+n.entry_id+"]").attr("data-videotitle"))),o},a=e=>{if(!e)return;let t=e.flashvars;t||(t=e.flashvars={});let n=t.vast;n||(n=t.vast={});let o=t.doubleClick;o||(o=t.doubleClick={}),o.adTagUrl=n.prerollUrl,n.prerollUrl=void 0},r=t=>{if(!t)return;const n=function(t,n,o,i,a){if("overlay"!==o)return;const r=e("#"+this.id+" iframe").contents(),s=this.id+"_overlay_btn_close_css_fix";r.find("html head style#"+s).length||r.find("html head").append(e('<style type="text/css" id="'+s+'" />').html(".mwPlayerContainer .videoHolder .btn.icon-close {   height: 1.5em !important;   width: 1.5em !important;   border-radius: .7em !important;   position: absolute !important;   top: -.75em !important;   right: -.75em !important;   line-height: 1.5em !important;   text-align: center !important;}"))};l(t,(function(e){document.getElementById(e).kBind("onAdPlay",n)}))},s=t=>{if(!t)return;const n=function(t,n,o,i,a){if("overlay"===o)return;const r=e("#"+this.id+" iframe").contents(),s=this.id+"_linear_ad_notice_css_fix";r.find("html head style#"+s).length||r.find("html head").append(e('<style type="text/css" id="'+s+'" />').html(".ad-component {   font-size: 11px !important;   line-height: 21px !important;}.ad-skip-btn {   font-size: 18px !important;}"))};l(t,(function(e){document.getElementById(e).kBind("onAdPlay",n)}))},l=(e,t)=>{if(!e||!t)return;const n=e.readyCallback;e.readyCallback="function"==typeof n?function(e){n.call(this,e),t.call(this,e)}:t};window.KalturaVideoAdConfig=e=>{e&&e.player&&e.ads&&(t=window.adConfig,n=window.videoAdConfig,e.ads.showOverlay&&(e=>{if(!e)return;let t=e.flashvars;t||(t=e.flashvars={});let i=t.vast;i||(i=t.vast={}),i.overlayUrl=o(e,n.overlayUnitPath),i.overlayStartAt="0",i.timeout="86400"})(e.player),e.ads.showPreroll&&(e=>{if(!e)return;let t=e.flashvars;t||(t=e.flashvars={});let i=t.vast;i||(i=t.vast={}),i.prerollUrl=o(e,n.prerollUnitPath),a(e)})(e.player),e.ads.showOverlay&&r(e.player),e.ads.showPreroll&&((e=>{if(!e)return;let t=e.flashvars;t||(t=e.flashvars={});let n=t.noticeMessage;n||(n=t.noticeMessage={}),n.text||(n.text="Advertisement {sequenceProxy.timeRemaining}");let o=t.skipBtn;o||(o=t.skipBtn={}),o.skipOffset||(o.skipOffset=5);let i=t.skipNotice;i||(i=t.skipNotice={}),i.text||(i.text="You can skip this ad in {sequenceProxy.skipOffsetRemaining}")})(e.player),s(e.player)),(e=>{if(!e)return;let t=e.flashvars;if(t||(t=e.flashvars={}),t.autoPlay&&(window.performance.navigation.type!==window.performance.navigation.TYPE_NAVIGATE||0!==document.referrer.indexOf(location.protocol+"//"+location.host))){const e=window.MWEMBED_VERSION.split(".");e[0]>2||2==e[0]&&e[1]>=62||(t.autoMute=!0)}})(e.player))}},18553:(e,t,n)=>{"use strict";const o=e=>{let t;return t=(e=e||window.location.href).replace(/[:/?&=]/g," "),t=t.replace(/['=!#~;<>&\+\*\^\(\)\[\]\,\"_]/g," "),t=t.replace(/[ |\s]+/g," "),t},i=(e,t)=>{if(!e)return;if(t){const n=Object.keys(t);for(let o=0;o<n.length;o++)e.setTargeting(n[o],t[n[o]])}const n=window.moatPrebidApi;n&&n.slotDataAvailable&&n.slotDataAvailable()&&n.setMoatTargetingForSlot(e)},a=e=>{const t=window.jQuery;let n=[];return t&&e&&(n=t(e).toArray()),n},r=(e,t)=>{let n=[];const o=e.split(",");for(const e in o){const t=a(o[e]);n=n.concat(t)}if(!n||!n.length||t<=0)return null;n=n.filter(((e,t)=>n.indexOf(e)===t));let i=[];const r=n.length/t;if(r<=1)i=n;else if(r>1&&r<=2)i=n.slice(0,t);else if(r>2){const e=Math.floor(r),t=n.length-Math.floor(n.length/e)*e-1;for(let o=0;o<n.length;o++){const a=(o-t)%e==0;(o<t-1||a)&&i.push(n[o])}}return i},s=e=>{const t=document.createElement("div"),n=document.createElement("div"),o=Object.keys(e),i=(e,t,n)=>{e.setAttribute(t,n)};i(t,"class","ej-advertisement-content");for(let t=0;t<o.length;t++){const a=o[t];i(n,a,e[a])}return t.appendChild(n),t},l=e=>{if(!e)return!1;try{const t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)}catch(e){}},d=function(){this.adConfig={};let e=0;const t=[],n={},o="ej-advertisement-title";this.configure=e=>{this.adConfig=e};const a=e=>{let t=document.getElementById(e.id);if(!t)return null;if(e.outOfPage)t=c.defineOutOfPageSlot(e.adPath,e.id).addService(c.pubads());else try{t=c.defineSlot(e.adPath,[],e.id).defineSizeMapping(e.sizeMap).addService(c.pubads())}catch(e){c.pubads().refresh()}return t},d=e=>{if(!e)return;const t=document.getElementById(e.id);if(t.setAttribute("id",""),e.displaySlug){const e=document.createElement("div");e.classList.add(o),t.appendChild(e)}const n=document.createElement("div");n.setAttribute("id",e.id),t.appendChild(n),n.classList.add("ad-placeholder")};this.setPageTargeting=e=>{if(!e)return;const t=Object.keys(e);for(let n=0;n<t.length;n++)c.pubads().setTargeting(t[n],e[t[n]])};const g=t=>{e<=0?window.removeEventListener("scroll",g):f()},f=()=>{for(let o=0;o<t.length;o++){const a=n[t[o]],r=document.getElementById(a.id);if(!r)return;!1===a.refreshed&&(!1===this.adConfig.lazyLoadingEnabled||a.autoLoad||l(r))&&c.cmd.push((()=>{i(a.slot,a.slotTargeting),c.display(a.id),this.adConfig.lazyLoadingEnabled&&c.pubads().refresh([a.slot]),a.refreshed=!0,e--}))}};this.displayAds=()=>{window.bodyAdsConfiguration&&(e=>{if(e&&e.length)for(const t in e){const n=e[t],o=r(n.cssSelectors,n.slots.length);if(o)for(const e in o){const t=o[e],i=n.slots[e],a=s(i);t.parentNode.insertBefore(a,t.nextSibling)}}})(window.bodyAdsConfiguration),((e,t,n)=>{let o=document.querySelectorAll(`div.${n}`);o&&o.length&&(o=[].slice.call(o),o.map((n=>{const o=n,i=o.getAttribute("id");if(!i)return;t.push(i);const a={};a.id=i,a.sizeMap=o.dataset.sizemap?JSON.parse(o.dataset.sizemap):[],a.refreshed=!1,a.adPath=o.dataset.adpath,a.autoLoad="yes"===o.dataset.autoload,a.outOfPage="yes"===o.dataset.outofpage,a.sticky="yes"===o.dataset.sticky,a.slotTargeting=o.dataset.slottargeting?JSON.parse(o.dataset.slottargeting):{},a.displaySlug="yes"===o.dataset.displayslug,e[i]=a})))})(n,t,this.adConfig.slotClass),c.cmd.push((()=>{(()=>{const t=Object.keys(n);for(let o=0;o<t.length;o++){const i=n[t[o]];d(i),i.slot=a(i),i.slot&&!1===i.refreshed&&e++}})(),this.setPageTargeting(this.adConfig.pageTargeting),c.pubads().collapseEmptyDivs(),this.adConfig.lazyLoadingEnabled&&c.pubads().disableInitialLoad(),c.enableServices(),f(),c.pubads().addEventListener("slotOnload",(e=>{const t=e.slot.getSlotElementId(),i=n[t],a=document.getElementById(i.id),r=this.adConfig.topBanner.stickyDuration;i&&i.displaySlug&&!1===i.outOfPage&&((e,t,n)=>{if(!e)return;const o=e.parentNode.querySelector(`.${t}`);o&&(o.textContent=n)})(a,o,this.adConfig.adTitle),i&&!0===i.sticky&&a&&((e,t)=>{let n=!0;const o="stick-top",i=document.querySelector(".advertisement-content_top");if(i&&i.clientHeight/window.innerHeight<=.3){const e=i.clientHeight,a=()=>{window.scrollY>e/2?n&&(i.classList.add(o),null!==document.querySelector(".header.fixed"))&&"0px"===window.getComputedStyle(document.querySelector(".header.fixed")).top&&(document.querySelector(".header.fixed").style.top=i.offsetHeight.toString()+"px"):(i.classList.remove(o),null!==document.querySelector(".header.fixed")&&(document.querySelector(".header.fixed").style.top=""))};setTimeout((()=>{n=!1,i.classList.remove(o),null!==document.querySelector(".header.fixed")&&(document.querySelector(".header.fixed").style.top=""),window.removeEventListener("scroll",a)}),t),a(),window.addEventListener("scroll",a)}})(0,r)}))})),window.addEventListener("scroll",g)}},c=window.googletag||{};c.cmd=c.cmd||[],window.adService=new d;n(19265);const g=(e,t)=>({delay:e||!1,period:t||0}),f=()=>{let e=g();return window.moatPrebidApi&&window.moatPrebidApi.slotDataAvailable&&window.moatPrebidApi.slotDataAvailable()||(e=g(!0,1e3)),e},u=(e,t)=>{let n=g();return e&&!t&&(n=g(!0,1e3)),n},p=()=>{try{const e=window.adService,t=((e="js-ad-config")=>{const t=document.querySelector(`.${e}`);if(!t)return null;const n=t.dataset.videoadconfig,o=t.dataset.adconfig;if(!o||!n)return null;const i={},a=JSON.parse(o);return a.pageTargeting=a.pageTargeting||{},i.adConfig=a,i.videoAdConfig=JSON.parse(n),i})();if(!t)return;const n=t.adConfig;window.adConfig=n;const i=t.videoAdConfig;window.videoAdConfig=i;let a=!1;const r=n.contextTargetingEnabled;(()=>{if(n.pageTargeting.URL=window.location.href,n.pageTargeting.UrlSegments=o(),n.pageTargeting.UriSegments=(e=>{let t=[];try{e=e||window.location.href;const n=o(e);n&&(t=n.split(" "))}catch(e){window.console.error(e)}return t})(),n.pageTargeting.cid=n.npiHash,r){const e=e=>{e&&(n.pageTargeting.gs_cat=e,a=!0)},t=window.wk&&window.wk.ct?window.wk.ct.getSegments:null;if(t&&"function"==typeof t){t(window.location.href,e,!1)}}})();(()=>{const t=(e=>{let t=g();for(let n=0;n<e.length;n++){const o=(0,e[n])();if(o&&o.delay){t=o;break}}return t})([u.bind(null,r,a),f]);e.configure(n);const o=e.displayAds.bind(e);setTimeout(o,t.period)})()}catch(e){console.log(`Error in adsInit: ${e.message}`)}};p()}},e=>{var t;t=18553,e(e.s=t)}]);
//# sourceMappingURL=ads.js.map