!function(e){e.fn.buildFigureCarousel=function(t){t=e.extend({speed:500,access:!1,autoplay:!1,delay:1e4,defaultpaddingbottom:10},t);var n,a,i=e(this);i.find(".carousel-item").each((function(t,n){var a=e(n),i=a.attr("data-doi");i=i.replace(/^info:doi\//,"");var o=e('.figure[data-doi="'+i+'"]');a.find("a").attr("href","#"+o.attr("id"))})),n=i,(a=e(".articleinfo")).length&&(n.detach(),n.insertBefore(a)),n.show();var o=i.find(".carousel-wrapper"),r=o.find(".slider");function s(){return r.find(".carousel-item")}for(var l=s(),c=l.eq(0).outerWidth(),d=Math.ceil(o.innerWidth()/c),f=Math.ceil(l.length/d),u=(d-l.length%d)%d,p=0;p<u;p++)r.append(e('<div class="empty carousel-item"/>'));(l=s()).filter(":first").before(l.slice(-d).clone().addClass("clone")),l.filter(":last").after(l.slice(0,d).clone().addClass("clone")),l=s(),o.scrollLeft(c*d);var h=0;function v(e){var n=e-h;if(0!=n){var a=c*d*n;o.filter(":not(:animated)").animate({scrollLeft:"+="+a},t.speed,(function(){e<0?(o.scrollLeft(c*d*f),h=f-1):e>=f?(o.scrollLeft(c*d),h=0):h=e;var t=i.find(".carousel-page-buttons .index");t.removeClass("active"),t.eq(h).addClass("active")}))}}var g=i.find(".carousel-control");if(f>1?(g.find(".button.previous").click((function(){v(h-1)})),g.find(".button.next").click((function(){v(h+1)}))):g.hide(),e("html.touch").length&&o.swipe({swipe:function(e,t){g.addClass("controls-show")},swipeLeft:function(e,t){v(h-1)},swipeRight:function(e,t){v(h+1)},tap:function(e,t){g.addClass("controls-show")},threshold:20}),f>1){function m(t){var n=e('<span class="index">&nbsp;</span>');return n.click((function(){v(t)})),n}var b=i.find(".carousel-page-buttons");for(p=0;p<f;p++){var w=m(p);0==p&&w.addClass("active"),b.append(w)}}}}(jQuery);