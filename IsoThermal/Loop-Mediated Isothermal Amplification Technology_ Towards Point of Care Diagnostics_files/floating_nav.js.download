!function(t){var i=t(window),n=window.location.hash;t.fn.floatingNav=function(o){var s=t(this),e=i.scrollTop(),a=t.extend({margin:90,margin_bottom:35,page_width:960,scroll_speed:500,content:"",ul_class:"nav-page",section_anchor:"a[data-toc]",section_anchor_attr:"data-toc",class_active:"active",footer:"#pageftr",alternate_bottom_div:"#banner-ftr",link_selector:"a.scroll",ignored_sections:""},o);function c(t){if(!s.hasClass("scrolling")){var i=_.filter(t,(function(t){return t.topPosition<=e&&t.bottomPosition>=e}))[0];if(i){var n=i.$link.closest("li");n.parents("li").hasClass("active")?s.addClass("no-hidding"):s.removeClass("no-hidding"),s.find("li."+a.class_active).removeClass(a.class_active),n.addClass(a.class_active).parents("li").addClass(a.class_active)}else s.find("li."+a.class_active).removeClass(a.class_active)}}return this.each((function(){var o=[],r=function(){o=[];var i=s.find(a.link_selector);i.each((function(s){var e={},c=a.content.find(t(this).attr("href")),r=c.offset().top,l=0;if((g=a.content.find(i.eq(s+1).attr("href"))).offset())l=g.offset().top-1;else{var f=(l=a.content.height()+a.content.offset().top)-r,h=t(window).height();if(f+a.content.find(".final-section-spacing").height()+t("body > footer").innerHeight()<h){a.content.find(".final-section-spacing").length||a.content.append('<div class="final-section-spacing"></div>');var d=h-f-t("body > footer").innerHeight();a.content.find(".final-section-spacing").css("height",d+"px")}}var p=t("#floatTitleTop");if(p.length){var v=p.height()+20;n!="#"+c.attr(a.section_anchor_attr)&&(r-=v);var g=i.eq(s+1);n!=g.attr("href")&&(l-=v)}e.id=c.attr(a.section_anchor_attr),e.$element=c,e.$link=t(this),e.topPosition=r,e.bottomPosition=l,o.push(e)}))},l=function(){r(),c(o)};t("body").on("click","ul."+a.ul_class+" a",(function(i){r();var n=t(this).attr("href").substring(1),e=_.findWhere(o,{id:n});!function(i,n,o){o&&(o.preventDefault(),o.stopPropagation()),s.addClass("scrolling"),t("html,body").stop().animate({scrollTop:n.topPosition},500,(function(){s.removeClass("scrolling"),window.location.hash="#"+n.id,c(i)}))}(o,e,i)}));var f=function(){e=i.scrollTop();var n=t(a.footer).offset().top,o=s.innerHeight(),c=a.content.offset().top,r=e>c-a.margin,f=e<n-(o+a.margin);if(i.width()>=a.page_width)if(r&&f)s.css({position:"fixed",top:a.margin+"px"}),l();else if(e>n-(o+a.margin)){var h=n-e-o;l(),s.css({position:"fixed",top:h+"px"})}else s.css({position:"static"});else s.css({position:"static"}),l()};1===t("html.no-touch").length?(f(),i.scroll(f),i.resize(f)):(l(),i.scroll(l))}))}}(jQuery);